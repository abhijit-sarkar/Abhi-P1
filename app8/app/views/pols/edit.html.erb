<html>
  <head>
    
    <script type="text/javascript">
      $(document).ready(function(){
      var s=<%= session[:duration].to_f %>;
      
      $('#p1').css("display", "none");
      $('#p2').css("display", "none");
      
      var d = new Date();
      var month = d.getMonth();
      var day = Number(Number(d.getDate())+Number(s));
      var year=d.getFullYear();
      if(month < 10)
		 {
		 month='0'+month;
		 }
      if(day < 10)
		  {
		  day='0'+day;
		  }
      date=day+'/'+month+'/'+year;
      $('#matdate').val(date);
      });
   </script>
  </head>
  <body>
    <h2>Purchase Plan</h2>
    <%= form_for @pol do |f| %>
    <% if @pol.errors.any? %>
    <h4>Errors: </h4>
    <ul>
      <% @pol.errors.full_messages.each do|msg| %>
      <li><%= msg %></li>
      <% end %>
    </ul>
    <% end %>
    <table class = "table">
      <tbody>
	<tr id="p1">
	  <th>Plan ID :</th>
	  <td><%= f.text_field :plan_id  %></td>
	</tr>
	<tr>
	  <th>Plan Name :</th>
	  <td><%= Plan.find(session[:plan_id]).plan_name %></td>
	</tr>
	<tr id="p2">
	  <th>Customer ID :</th>
	  <td><%= f.text_field :customer_id %></td>
	</tr>
	<tr>
	  <th>Customer name :</th>
	  <td><%= Customer.find(session[:id]).cust_name %></td>
	</tr>
	<tr>
	  <th>Sum Insured :</th>
	  <td><%= f.text_field :sum_insured, :id => "sum1",:readonly => true,value: session[:premium] %></td>
        </tr>
         <tr>
           <th>Nominee :</th>
           <td><%= f.text_field :nominee %></td>
         </tr>
         <tr>
            <th>Duration :</th>
            <td><%= f.text_field :duration, :id=>"dur",:readonly => true,value: session[:duration] %></td>
         </tr>

         <tr  id="hid1">
           <th>Premium :</th>
           <td><%= f.text_field :premium,:id => "prem" ,:readonly => true ,value:(session[:premium].to_f/session[:duration].to_f) %></td>
         </tr>
         <tr  id="hid2">
           <th>Maturity amount :</th>
           <td><%= f.text_field :maturity_amount,:id => "matval",:readonly => true,value: (session[:premium].to_f*(1+(Plan.find(session[:plan_id]).roi.to_f/100))) %></td>
         </tr>
         <tr id="hid3">
           <th >Maturity Date :</th>
           <td><%= f.text_field :maturity_date,:id => "matdate",:readonly => true %></td>
         </tr>
         <tr>
           <td><%= f.submit "Purchase Plan", class:"btn btn-primary btn-md" %></td>
           <td><%= link_to "Cancel",selections_path, class:"btn btn-danger btn-md" %></td>
         </tr>

    </tbody>

   </table>
   <% end %>
  </body>
</html>
